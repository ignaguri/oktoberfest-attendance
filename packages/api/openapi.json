{
  "openapi": "3.1.0",
  "info": {
    "title": "ProstCounter API",
    "version": "0.1.0",
    "description": "API for ProstCounter - Oktoberfest attendance tracking"
  },
  "servers": [
    {
      "url": "http://localhost:3008/api",
      "description": "Local development"
    },
    {
      "url": "https://prostcounter.vercel.app/api",
      "description": "Production"
    }
  ],
  "components": {
    "schemas": {},
    "parameters": {}
  },
  "paths": {
    "/v1/consumption": {
      "post": {
        "tags": [
          "consumption"
        ],
        "summary": "Log a new beer or drink consumption",
        "description": "Records a consumption and updates the attendance record with computed totals",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "festivalId": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "date": {
                    "type": "string",
                    "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                  },
                  "tentId": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "drinkType": {
                    "type": "string",
                    "enum": [
                      "beer",
                      "radler",
                      "alcohol_free",
                      "wine",
                      "soft_drink",
                      "other"
                    ],
                    "default": "beer"
                  },
                  "drinkName": {
                    "type": "string",
                    "maxLength": 255
                  },
                  "basePriceCents": {
                    "type": "integer",
                    "minimum": 0
                  },
                  "pricePaidCents": {
                    "type": "integer",
                    "minimum": 0
                  },
                  "volumeMl": {
                    "type": "integer",
                    "minimum": 1,
                    "default": 1000
                  },
                  "recordedAt": {
                    "type": "string",
                    "format": "date-time"
                  },
                  "idempotencyKey": {
                    "type": "string",
                    "maxLength": 255
                  }
                },
                "required": [
                  "festivalId",
                  "date",
                  "pricePaidCents"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Consumption logged successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "userId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "festivalId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "date": {
                      "type": "string",
                      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "drinkCount": {
                      "type": "integer"
                    },
                    "beerCount": {
                      "type": "integer"
                    },
                    "totalSpentCents": {
                      "type": "integer"
                    },
                    "totalTipCents": {
                      "type": "integer"
                    },
                    "avgPriceCents": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "id",
                    "userId",
                    "festivalId",
                    "date",
                    "createdAt",
                    "updatedAt",
                    "drinkCount",
                    "beerCount",
                    "totalSpentCents",
                    "totalTipCents",
                    "avgPriceCents"
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/attendance": {
      "get": {
        "tags": [
          "attendance"
        ],
        "summary": "List user's attendance records",
        "description": "Returns paginated list of attendance records with computed totals",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "festivalId",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 50
            },
            "required": false,
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "nullable": true,
              "minimum": 0,
              "default": 0
            },
            "required": false,
            "name": "offset",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Attendances retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "userId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "festivalId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "date": {
                            "type": "string",
                            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "drinkCount": {
                            "type": "integer"
                          },
                          "beerCount": {
                            "type": "integer"
                          },
                          "totalSpentCents": {
                            "type": "integer"
                          },
                          "totalTipCents": {
                            "type": "integer"
                          },
                          "avgPriceCents": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "id",
                          "userId",
                          "festivalId",
                          "date",
                          "createdAt",
                          "updatedAt",
                          "drinkCount",
                          "beerCount",
                          "totalSpentCents",
                          "totalTipCents",
                          "avgPriceCents"
                        ]
                      }
                    },
                    "total": {
                      "type": "integer"
                    },
                    "limit": {
                      "type": "integer"
                    },
                    "offset": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "data",
                    "total",
                    "limit",
                    "offset"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/attendance/{id}": {
      "delete": {
        "tags": [
          "attendance"
        ],
        "summary": "Delete an attendance record",
        "description": "Deletes an attendance and all its associated consumptions (cascading delete)",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Attendance deleted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "success",
                    "message"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Attendance not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/festivals": {
      "get": {
        "tags": [
          "festivals"
        ],
        "summary": "List all festivals",
        "description": "Returns list of festivals with optional filtering by status or active state",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "enum": [
                "upcoming",
                "active",
                "ended"
              ]
            },
            "required": false,
            "name": "status",
            "in": "query"
          },
          {
            "schema": {
              "type": "boolean",
              "nullable": true
            },
            "required": false,
            "name": "isActive",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Festivals retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "name": {
                            "type": "string"
                          },
                          "startDate": {
                            "type": "string",
                            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                          },
                          "endDate": {
                            "type": "string",
                            "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                          },
                          "beerCost": {
                            "type": "integer",
                            "nullable": true
                          },
                          "location": {
                            "type": "string",
                            "nullable": true
                          },
                          "mapUrl": {
                            "type": "string",
                            "nullable": true,
                            "format": "uri"
                          },
                          "isActive": {
                            "type": "boolean"
                          },
                          "status": {
                            "type": "string",
                            "enum": [
                              "upcoming",
                              "active",
                              "ended"
                            ]
                          },
                          "timezone": {
                            "type": "string",
                            "nullable": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "startDate",
                          "endDate",
                          "beerCost",
                          "location",
                          "mapUrl",
                          "isActive",
                          "status",
                          "timezone",
                          "createdAt",
                          "updatedAt"
                        ]
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/festivals/{id}": {
      "get": {
        "tags": [
          "festivals"
        ],
        "summary": "Get festival by ID",
        "description": "Returns a single festival by its ID",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Festival retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "name": {
                      "type": "string"
                    },
                    "startDate": {
                      "type": "string",
                      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                    },
                    "endDate": {
                      "type": "string",
                      "pattern": "^\\d{4}-\\d{2}-\\d{2}$"
                    },
                    "beerCost": {
                      "type": "integer",
                      "nullable": true
                    },
                    "location": {
                      "type": "string",
                      "nullable": true
                    },
                    "mapUrl": {
                      "type": "string",
                      "nullable": true,
                      "format": "uri"
                    },
                    "isActive": {
                      "type": "boolean"
                    },
                    "status": {
                      "type": "string",
                      "enum": [
                        "upcoming",
                        "active",
                        "ended"
                      ]
                    },
                    "timezone": {
                      "type": "string",
                      "nullable": true
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "startDate",
                    "endDate",
                    "beerCost",
                    "location",
                    "mapUrl",
                    "isActive",
                    "status",
                    "timezone",
                    "createdAt",
                    "updatedAt"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Festival not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/tents": {
      "get": {
        "tags": [
          "tents"
        ],
        "summary": "List tents for a festival",
        "description": "Returns list of tents with festival-specific pricing and availability",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "festivalId",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Tents retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "festivalId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "tentId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "beerPrice": {
                            "type": "integer",
                            "nullable": true
                          },
                          "isOpen": {
                            "type": "boolean"
                          },
                          "tent": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string",
                                "nullable": true
                              },
                              "capacity": {
                                "type": "integer",
                                "nullable": true
                              },
                              "website": {
                                "type": "string",
                                "nullable": true,
                                "format": "uri"
                              },
                              "createdAt": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "updatedAt": {
                                "type": "string",
                                "format": "date-time"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "description",
                              "capacity",
                              "website",
                              "createdAt",
                              "updatedAt"
                            ]
                          }
                        },
                        "required": [
                          "festivalId",
                          "tentId",
                          "beerPrice",
                          "isOpen",
                          "tent"
                        ]
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/groups": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Create a new group",
        "description": "Creates a group and automatically adds the creator as the first member",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "name": {
                    "type": "string",
                    "minLength": 1,
                    "maxLength": 100
                  },
                  "festivalId": {
                    "type": "string",
                    "format": "uuid"
                  },
                  "winningCriteria": {
                    "type": "string",
                    "enum": [
                      "days_attended",
                      "total_beers",
                      "avg_beers"
                    ],
                    "default": "total_beers"
                  }
                },
                "required": [
                  "name",
                  "festivalId"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Group created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "name": {
                      "type": "string"
                    },
                    "festivalId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "winningCriteria": {
                      "type": "string",
                      "enum": [
                        "days_attended",
                        "total_beers",
                        "avg_beers"
                      ]
                    },
                    "inviteToken": {
                      "type": "string"
                    },
                    "createdBy": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "festivalId",
                    "winningCriteria",
                    "inviteToken",
                    "createdBy",
                    "createdAt",
                    "updatedAt"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      },
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "List user's groups",
        "description": "Returns all groups the user is a member of",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": false,
            "name": "festivalId",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Groups retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "name": {
                            "type": "string"
                          },
                          "festivalId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "winningCriteria": {
                            "type": "string",
                            "enum": [
                              "days_attended",
                              "total_beers",
                              "avg_beers"
                            ]
                          },
                          "inviteToken": {
                            "type": "string"
                          },
                          "createdBy": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "updatedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "memberCount": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "id",
                          "name",
                          "festivalId",
                          "winningCriteria",
                          "inviteToken",
                          "createdBy",
                          "createdAt",
                          "updatedAt",
                          "memberCount"
                        ]
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/groups/{id}": {
      "get": {
        "tags": [
          "groups"
        ],
        "summary": "Get group details",
        "description": "Returns group information including member count",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Group retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "name": {
                      "type": "string"
                    },
                    "festivalId": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "winningCriteria": {
                      "type": "string",
                      "enum": [
                        "days_attended",
                        "total_beers",
                        "avg_beers"
                      ]
                    },
                    "inviteToken": {
                      "type": "string"
                    },
                    "createdBy": {
                      "type": "string",
                      "format": "uuid"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "format": "date-time"
                    },
                    "memberCount": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "festivalId",
                    "winningCriteria",
                    "inviteToken",
                    "createdBy",
                    "createdAt",
                    "updatedAt",
                    "memberCount"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Not a group member",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/groups/{id}/join": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Join a group",
        "description": "Join a group using an optional invite token",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "inviteToken": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Successfully joined group",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "success",
                    "message"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Invalid invite token",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "409": {
            "description": "Conflict - Already a member",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/groups/{id}/leave": {
      "post": {
        "tags": [
          "groups"
        ],
        "summary": "Leave a group",
        "description": "Remove yourself from a group",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          }
        ],
        "responses": {
          "200": {
            "description": "Successfully left group",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "success",
                    "message"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Not a group member",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/leaderboard": {
      "get": {
        "tags": [
          "leaderboard"
        ],
        "summary": "Get global leaderboard",
        "description": "Returns ranked list of all users for a festival with pagination",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "festivalId",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "days_attended",
                "total_beers",
                "avg_beers"
              ],
              "default": "total_beers"
            },
            "required": false,
            "name": "sortBy",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "minimum": 1,
              "maximum": 100,
              "default": 50
            },
            "required": false,
            "name": "limit",
            "in": "query"
          },
          {
            "schema": {
              "type": "integer",
              "nullable": true,
              "minimum": 0,
              "default": 0
            },
            "required": false,
            "name": "offset",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Leaderboard retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "userId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "username": {
                            "type": "string"
                          },
                          "fullName": {
                            "type": "string",
                            "nullable": true
                          },
                          "avatarUrl": {
                            "type": "string",
                            "nullable": true,
                            "format": "uri"
                          },
                          "daysAttended": {
                            "type": "integer"
                          },
                          "totalBeers": {
                            "type": "integer"
                          },
                          "avgBeers": {
                            "type": "number"
                          },
                          "position": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "userId",
                          "username",
                          "fullName",
                          "avatarUrl",
                          "daysAttended",
                          "totalBeers",
                          "avgBeers",
                          "position"
                        ]
                      }
                    },
                    "total": {
                      "type": "integer"
                    },
                    "limit": {
                      "type": "integer"
                    },
                    "offset": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "data",
                    "total",
                    "limit",
                    "offset"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/groups/{id}/leaderboard": {
      "get": {
        "tags": [
          "leaderboard"
        ],
        "summary": "Get group leaderboard",
        "description": "Returns ranked list of group members",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "id",
            "in": "path"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "days_attended",
                "total_beers",
                "avg_beers"
              ]
            },
            "required": false,
            "name": "sortBy",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Group leaderboard retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "userId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "username": {
                            "type": "string"
                          },
                          "fullName": {
                            "type": "string",
                            "nullable": true
                          },
                          "avatarUrl": {
                            "type": "string",
                            "nullable": true,
                            "format": "uri"
                          },
                          "daysAttended": {
                            "type": "integer"
                          },
                          "totalBeers": {
                            "type": "integer"
                          },
                          "avgBeers": {
                            "type": "number"
                          },
                          "position": {
                            "type": "integer"
                          }
                        },
                        "required": [
                          "userId",
                          "username",
                          "fullName",
                          "avatarUrl",
                          "daysAttended",
                          "totalBeers",
                          "avgBeers",
                          "position"
                        ]
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - Not a group member",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Group not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/achievements": {
      "get": {
        "tags": [
          "achievements"
        ],
        "summary": "List user's achievements",
        "description": "Returns all achievements unlocked by the user for a festival",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "parameters": [
          {
            "schema": {
              "type": "string",
              "format": "uuid"
            },
            "required": true,
            "name": "festivalId",
            "in": "query"
          },
          {
            "schema": {
              "type": "string",
              "enum": [
                "consumption",
                "attendance",
                "explorer",
                "social",
                "competitive",
                "special"
              ]
            },
            "required": false,
            "name": "category",
            "in": "query"
          }
        ],
        "responses": {
          "200": {
            "description": "Achievements retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "userId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "achievementId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "festivalId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "rarity": {
                            "type": "string",
                            "enum": [
                              "common",
                              "rare",
                              "epic",
                              "legendary"
                            ]
                          },
                          "unlockedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "userNotifiedAt": {
                            "type": "string",
                            "nullable": true,
                            "format": "date-time"
                          },
                          "groupNotifiedAt": {
                            "type": "string",
                            "nullable": true,
                            "format": "date-time"
                          },
                          "achievement": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string",
                                "enum": [
                                  "consumption",
                                  "attendance",
                                  "explorer",
                                  "social",
                                  "competitive",
                                  "special"
                                ]
                              },
                              "icon": {
                                "type": "string"
                              },
                              "points": {
                                "type": "integer"
                              },
                              "rarity": {
                                "type": "string",
                                "enum": [
                                  "common",
                                  "rare",
                                  "epic",
                                  "legendary"
                                ]
                              },
                              "condition": {
                                "type": "object",
                                "additionalProperties": {
                                  "nullable": true
                                }
                              },
                              "createdAt": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "updatedAt": {
                                "type": "string",
                                "format": "date-time"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "description",
                              "category",
                              "icon",
                              "points",
                              "rarity",
                              "condition",
                              "createdAt",
                              "updatedAt"
                            ]
                          }
                        },
                        "required": [
                          "id",
                          "userId",
                          "achievementId",
                          "festivalId",
                          "rarity",
                          "unlockedAt",
                          "userNotifiedAt",
                          "groupNotifiedAt",
                          "achievement"
                        ]
                      }
                    }
                  },
                  "required": [
                    "data"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/achievements/evaluate": {
      "post": {
        "tags": [
          "achievements"
        ],
        "summary": "Evaluate achievements",
        "description": "Manually triggers achievement evaluation for the user. Returns newly unlocked achievements.",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "festivalId": {
                    "type": "string",
                    "format": "uuid"
                  }
                },
                "required": [
                  "festivalId"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Achievement evaluation completed",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "newAchievements": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "userId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "achievementId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "festivalId": {
                            "type": "string",
                            "format": "uuid"
                          },
                          "rarity": {
                            "type": "string",
                            "enum": [
                              "common",
                              "rare",
                              "epic",
                              "legendary"
                            ]
                          },
                          "unlockedAt": {
                            "type": "string",
                            "format": "date-time"
                          },
                          "userNotifiedAt": {
                            "type": "string",
                            "nullable": true,
                            "format": "date-time"
                          },
                          "groupNotifiedAt": {
                            "type": "string",
                            "nullable": true,
                            "format": "date-time"
                          },
                          "achievement": {
                            "type": "object",
                            "properties": {
                              "id": {
                                "type": "string",
                                "format": "uuid"
                              },
                              "name": {
                                "type": "string"
                              },
                              "description": {
                                "type": "string"
                              },
                              "category": {
                                "type": "string",
                                "enum": [
                                  "consumption",
                                  "attendance",
                                  "explorer",
                                  "social",
                                  "competitive",
                                  "special"
                                ]
                              },
                              "icon": {
                                "type": "string"
                              },
                              "points": {
                                "type": "integer"
                              },
                              "rarity": {
                                "type": "string",
                                "enum": [
                                  "common",
                                  "rare",
                                  "epic",
                                  "legendary"
                                ]
                              },
                              "condition": {
                                "type": "object",
                                "additionalProperties": {
                                  "nullable": true
                                }
                              },
                              "createdAt": {
                                "type": "string",
                                "format": "date-time"
                              },
                              "updatedAt": {
                                "type": "string",
                                "format": "date-time"
                              }
                            },
                            "required": [
                              "id",
                              "name",
                              "description",
                              "category",
                              "icon",
                              "points",
                              "rarity",
                              "condition",
                              "createdAt",
                              "updatedAt"
                            ]
                          }
                        },
                        "required": [
                          "id",
                          "userId",
                          "achievementId",
                          "festivalId",
                          "rarity",
                          "unlockedAt",
                          "userNotifiedAt",
                          "groupNotifiedAt",
                          "achievement"
                        ]
                      }
                    },
                    "totalPoints": {
                      "type": "integer"
                    }
                  },
                  "required": [
                    "newAchievements",
                    "totalPoints"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/notifications/token": {
      "post": {
        "tags": [
          "notifications"
        ],
        "summary": "Register FCM device token",
        "description": "Registers a Firebase Cloud Messaging device token with Novu for push notifications",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "token": {
                    "type": "string",
                    "minLength": 1
                  }
                },
                "required": [
                  "token"
                ]
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "FCM token registered successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "success"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/notifications/subscribe": {
      "post": {
        "tags": [
          "notifications"
        ],
        "summary": "Subscribe user to Novu",
        "description": "Subscribes a user to Novu notification system with their profile data",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "email": {
                    "type": "string",
                    "format": "email"
                  },
                  "firstName": {
                    "type": "string"
                  },
                  "lastName": {
                    "type": "string"
                  },
                  "avatar": {
                    "type": "string",
                    "format": "uri"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User subscribed successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "success"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    },
    "/v1/notifications/preferences": {
      "get": {
        "tags": [
          "notifications"
        ],
        "summary": "Get notification preferences",
        "description": "Retrieves the user's notification preferences",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "responses": {
          "200": {
            "description": "Preferences retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "nullable": true,
                  "properties": {
                    "userId": {
                      "type": "string",
                      "nullable": true,
                      "format": "uuid"
                    },
                    "pushEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "groupJoinEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "checkinEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "remindersEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "achievementNotificationsEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "groupNotificationsEnabled": {
                      "type": "boolean",
                      "nullable": true
                    },
                    "createdAt": {
                      "type": "string",
                      "nullable": true,
                      "format": "date-time"
                    },
                    "updatedAt": {
                      "type": "string",
                      "nullable": true,
                      "format": "date-time"
                    }
                  },
                  "required": [
                    "userId",
                    "pushEnabled",
                    "groupJoinEnabled",
                    "checkinEnabled",
                    "remindersEnabled",
                    "achievementNotificationsEnabled",
                    "groupNotificationsEnabled",
                    "createdAt",
                    "updatedAt"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": [
          "notifications"
        ],
        "summary": "Update notification preferences",
        "description": "Updates the user's notification preferences",
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "pushEnabled": {
                    "type": "boolean"
                  },
                  "groupJoinEnabled": {
                    "type": "boolean"
                  },
                  "checkinEnabled": {
                    "type": "boolean"
                  },
                  "remindersEnabled": {
                    "type": "boolean"
                  },
                  "achievementNotificationsEnabled": {
                    "type": "boolean"
                  },
                  "groupNotificationsEnabled": {
                    "type": "boolean"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Preferences updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  },
                  "required": [
                    "success"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string"
                    },
                    "message": {
                      "type": "string"
                    }
                  },
                  "required": [
                    "error",
                    "message"
                  ]
                }
              }
            }
          }
        }
      }
    }
  }
}